{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * XDocReportKar – Word Add-in (Office.js)\n * Versión optimizada para Texto Plano (sin bordes ni símbolos)\n */\n\nlet allFields = { G: [], U: [], P: [] };\nlet currentTab = \"G\";\n\n/* =========================\n   INICIALIZACIÓN\n   ========================= */\n\nOffice.onReady((info) => {\n    if (info.host === Office.HostType.Word) {\n        document.getElementById(\"fileInput\").addEventListener(\"change\", handleFile);\n        document.getElementById(\"txtFiltro\").addEventListener(\"input\", renderList);\n\n        document.getElementById(\"btnAZ\").onclick = () => sortAndRender(true);\n        document.getElementById(\"btnZA\").onclick = () => sortAndRender(false);\n\n        document.getElementById(\"btnForeach\").onclick =\n            () => insertCampo(\"#foreach($r in $resultados)\");\n\n        document.getElementById(\"btnEnd\").onclick =\n            () => insertCampo(\"#end\");\n\n        document.querySelectorAll(\".tab\").forEach(tab => {\n            tab.onclick = (e) => {\n                document.querySelectorAll(\".tab\").forEach(t => t.classList.remove(\"active\"));\n                e.target.classList.add(\"active\");\n\n                currentTab = e.target.dataset.type;\n                document.getElementById(\"bucleActions\").style.display =\n                    (currentTab === \"P\") ? \"flex\" : \"none\";\n\n                renderList();\n            };\n        });\n    }\n});\n\n\n/* =========================\n   CARGA DEL XML .fields\n   ========================= */\n\nfunction handleFile(event) {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    document.getElementById(\"fileName\").innerText = file.name;\n\n    const reader = new FileReader();\n    reader.onload = function (e) {\n        const parser = new DOMParser();\n        const xmlDoc = parser.parseFromString(e.target.result, \"text/xml\");\n        const nodes = xmlDoc.getElementsByTagName(\"field\");\n\n        allFields = { G: [], U: [], P: [] };\n\n        for (let node of nodes) {\n            const name = node.getAttribute(\"name\");\n            if (!name) continue;\n\n            const lower = name.toLowerCase();\n            if (lower.startsWith(\"resultados.\")) {\n                allFields.P.push(name);\n            } else if (lower.startsWith(\"resultado.\")) {\n                allFields.U.push(name);\n            } else {\n                allFields.G.push(name);\n            }\n        }\n\n        sortAndRender(true);\n    };\n\n    reader.readAsText(file);\n}\n\n/* =========================\n   UI\n   ========================= */\n\nfunction renderList() {\n    const filter = document.getElementById(\"txtFiltro\").value.toLowerCase();\n    const container = document.getElementById(\"lstCampos\");\n    container.innerHTML = \"\";\n\n    const list = allFields[currentTab];\n    if (!list || list.length === 0) {\n        container.innerHTML =\n            `<div style=\"padding:20px;color:#999;text-align:center;\">\n                Carga un XML o cambia de pestaña\n             </div>`;\n        return;\n    }\n\n    list\n        .filter(item => item.toLowerCase().includes(filter))\n        .forEach(item => {\n            const div = document.createElement(\"div\");\n            div.className = \"item\";\n            div.innerText = item;\n\n            div.onclick = () => {\n                if (currentTab === \"P\") {\n                    // PLURAL → Velocity ($r.xxx)\n                    const campo = \"$r.\" + item.split(\".\").slice(1).join(\".\");\n                    insertCampo(campo);\n                } else {\n                    // GENERAL / ÚNICO → $campo\n                    insertCampo(\"$\" + item);\n                }\n            };\n\n            container.appendChild(div);\n        });\n}\n\nfunction sortAndRender(asc) {\n    const m = asc ? 1 : -1;\n    Object.keys(allFields).forEach(k => {\n        allFields[k].sort((a, b) => a.localeCompare(b) * m);\n    });\n    renderList();\n}\n\n/* =========================\n   INSERCIÓN SEGURA (TEXTO PLANO)\n   ========================= */\n\nasync function insertCampo(text) {\n    await Word.run(async (context) => {\n        const selection = context.document.getSelection();\n\n        // 1. Creamos el Content Control (indispensable para que XDocReport lo detecte)\n        const cc = selection.insertContentControl();\n        \n        // 2. Asignamos el código Velocity al Tag y Title\n        cc.title = text;\n        cc.tag = text;\n\n        /**\n         * 3. CONFIGURACIÓN DE TEXTO PLANO\n         * \"Hidden\" elimina el recuadro gris y la etiqueta visual de Word.\n         * El campo existirá en el código, pero el usuario lo verá como texto normal.\n         */\n        cc.appearance = \"Hidden\"; \n\n        /**\n         * 4. INSERCIÓN DEL TEXTO\n         * Insertamos el texto directamente sin los símbolos « ».\n         * Esto garantiza que en el documento final no quede rastro de caracteres extra.\n         */\n        cc.insertText(text, Word.InsertLocation.replace);\n\n        // 5. Gestión del cursor: movemos el foco fuera del control para evitar escribir dentro\n        const after = cc.getRange(Word.RangeLocation.after);\n        after.insertText(\" \", Word.InsertLocation.after);\n        after.select(Word.SelectionMode.end);\n\n        await context.sync();\n    });\n}\n\n/* =========================\n   LIMPIEZA FINAL\n   ========================= */\n\nasync function limpiarContentControls() {\n    await Word.run(async (context) => {\n        const controls = context.document.contentControls;\n        controls.load(\"items\");\n\n        await context.sync();\n\n        // Elimina el control PERO conserva el texto (Útil para procesos manuales)\n        controls.items.forEach(cc => {\n            cc.remove(false);\n        });\n\n        await context.sync();\n    });\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>XDocReportKar</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link rel=\\\"stylesheet\\\" href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"/> </head> <body class=\\\"ms-font-m\\\"> <div class=\\\"main-container\\\"> <div class=\\\"file-section\\\"> <label class=\\\"custom-file-upload\\\"> <input type=\\\"file\\\" id=\\\"fileInput\\\" accept=\\\".xml\\\" style=\\\"display:none\\\"> Elegir archivo XML </label> <span id=\\\"fileName\\\">...</span> </div> <div class=\\\"search-row\\\"> <input type=\\\"text\\\" id=\\\"txtFiltro\\\" class=\\\"search-box\\\" placeholder=\\\"Filtrar campos...\\\"> <button id=\\\"btnAZ\\\" class=\\\"btn-sort\\\">AZ</button> <button id=\\\"btnZA\\\" class=\\\"btn-sort\\\">ZA</button> </div> <div class=\\\"tabs\\\"> <div class=\\\"tab active\\\" data-type=\\\"G\\\">General</div> <div class=\\\"tab\\\" data-type=\\\"U\\\">Unicos</div> <div class=\\\"tab\\\" data-type=\\\"P\\\">Bucle</div> </div> <div id=\\\"bucleActions\\\"> <button id=\\\"btnForeach\\\" class=\\\"btn-action\\\">INICIO</button> <button id=\\\"btnEnd\\\" class=\\\"btn-action btn-secondary\\\">FIN</button> </div> <div id=\\\"lstCampos\\\" class=\\\"list-container\\\"> </div> </div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_arrayLikeToArray","Array","allFields","U","P","currentTab","handleFile","event","file","target","files","getElementById","innerText","name","reader","FileReader","onload","nodes","DOMParser","parseFromString","result","_step","_iterator","isArray","toString","slice","constructor","from","_unsupportedIterableToArray","_n","F","s","next","_createForOfIteratorHelper","getAttribute","lower","toLowerCase","startsWith","push","err","sortAndRender","readAsText","renderList","filter","container","innerHTML","list","item","includes","forEach","div","createElement","className","onclick","insertCampo","split","join","appendChild","asc","keys","k","sort","localeCompare","_x","_insertCampo","_callee2","text","_context2","Word","run","_ref","_callee","context","selection","cc","after","_context","getSelection","insertContentControl","title","tag","appearance","insertText","InsertLocation","getRange","RangeLocation","select","SelectionMode","end","sync","_x2","Office","onReady","info","host","HostType","addEventListener","querySelectorAll","tab","classList","remove","add","dataset","type","style","display","URL"],"ignoreList":[],"sourceRoot":""}